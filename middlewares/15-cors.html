<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>CORS | Node.js</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/nodejs/assets/css/0.styles.5ef21b33.css" as="style"><link rel="preload" href="/nodejs/assets/js/app.6530c3e6.js" as="script"><link rel="preload" href="/nodejs/assets/js/2.1eaf5745.js" as="script"><link rel="preload" href="/nodejs/assets/js/43.bf7527f9.js" as="script"><link rel="prefetch" href="/nodejs/assets/js/10.e5e910dd.js"><link rel="prefetch" href="/nodejs/assets/js/11.81f54750.js"><link rel="prefetch" href="/nodejs/assets/js/12.326eaa0e.js"><link rel="prefetch" href="/nodejs/assets/js/13.76f25957.js"><link rel="prefetch" href="/nodejs/assets/js/14.db4fbfc2.js"><link rel="prefetch" href="/nodejs/assets/js/15.d0df6143.js"><link rel="prefetch" href="/nodejs/assets/js/16.79f3b9f6.js"><link rel="prefetch" href="/nodejs/assets/js/17.e7a23b3d.js"><link rel="prefetch" href="/nodejs/assets/js/18.dba11a20.js"><link rel="prefetch" href="/nodejs/assets/js/19.f37e2453.js"><link rel="prefetch" href="/nodejs/assets/js/20.66d6a3d7.js"><link rel="prefetch" href="/nodejs/assets/js/21.2034969e.js"><link rel="prefetch" href="/nodejs/assets/js/22.e1be4913.js"><link rel="prefetch" href="/nodejs/assets/js/23.e9d6898e.js"><link rel="prefetch" href="/nodejs/assets/js/24.62e37a8d.js"><link rel="prefetch" href="/nodejs/assets/js/25.6a2bc373.js"><link rel="prefetch" href="/nodejs/assets/js/26.f0faf054.js"><link rel="prefetch" href="/nodejs/assets/js/27.3ff073d5.js"><link rel="prefetch" href="/nodejs/assets/js/28.09ea884b.js"><link rel="prefetch" href="/nodejs/assets/js/29.42642ab2.js"><link rel="prefetch" href="/nodejs/assets/js/3.b6b6cec9.js"><link rel="prefetch" href="/nodejs/assets/js/30.4361cb39.js"><link rel="prefetch" href="/nodejs/assets/js/31.16ba0b46.js"><link rel="prefetch" href="/nodejs/assets/js/32.fbaaecb0.js"><link rel="prefetch" href="/nodejs/assets/js/33.eb616f87.js"><link rel="prefetch" href="/nodejs/assets/js/34.2f1d7f5c.js"><link rel="prefetch" href="/nodejs/assets/js/35.ecb19f4a.js"><link rel="prefetch" href="/nodejs/assets/js/36.8c98c21e.js"><link rel="prefetch" href="/nodejs/assets/js/37.005fd8c1.js"><link rel="prefetch" href="/nodejs/assets/js/38.673a74fe.js"><link rel="prefetch" href="/nodejs/assets/js/39.98d85175.js"><link rel="prefetch" href="/nodejs/assets/js/4.ad1a3351.js"><link rel="prefetch" href="/nodejs/assets/js/40.fb372839.js"><link rel="prefetch" href="/nodejs/assets/js/41.0dd3eea9.js"><link rel="prefetch" href="/nodejs/assets/js/42.38377c86.js"><link rel="prefetch" href="/nodejs/assets/js/44.82fd539c.js"><link rel="prefetch" href="/nodejs/assets/js/45.d5513f89.js"><link rel="prefetch" href="/nodejs/assets/js/46.8560a64d.js"><link rel="prefetch" href="/nodejs/assets/js/47.e43ded3d.js"><link rel="prefetch" href="/nodejs/assets/js/48.f316f4e7.js"><link rel="prefetch" href="/nodejs/assets/js/49.7b51f97a.js"><link rel="prefetch" href="/nodejs/assets/js/5.0fc4ae49.js"><link rel="prefetch" href="/nodejs/assets/js/50.706e839b.js"><link rel="prefetch" href="/nodejs/assets/js/51.820c71e2.js"><link rel="prefetch" href="/nodejs/assets/js/52.36a5190e.js"><link rel="prefetch" href="/nodejs/assets/js/53.0f6ae399.js"><link rel="prefetch" href="/nodejs/assets/js/54.1688fc03.js"><link rel="prefetch" href="/nodejs/assets/js/55.b08d8b40.js"><link rel="prefetch" href="/nodejs/assets/js/56.0ec93108.js"><link rel="prefetch" href="/nodejs/assets/js/6.8d56e307.js"><link rel="prefetch" href="/nodejs/assets/js/7.5f4e3148.js"><link rel="prefetch" href="/nodejs/assets/js/8.75b88a8a.js"><link rel="prefetch" href="/nodejs/assets/js/9.5bc03069.js">
    <link rel="stylesheet" href="/nodejs/assets/css/0.styles.5ef21b33.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/nodejs/" class="router-link-active home-link"><img src="https://pablomagaz.com/content/images/2020/01/NodeJs.png" alt="Node.js" class="logo"> <span class="site-name">Node.js</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/nodejs/intro/">
          Intro
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/nodejs/core/">
          Core
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/nodejs/streams/">
          Streams
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/nodejs/express/">
          Express
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item ant-menu-item-selected"><a href="/nodejs/middlewares/" class="router-link-active">
          Middlewares
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/nodejs/mongodb/">
          MongoDB
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/nodejs/advanced/">
          Avanzado
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/nodejs/glossary/">
          Glosario
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <a href="https://github.com/rnovec" target="_blank" rel="noopener noreferrer" class="repo-link"><i aria-label="icon: github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></i></a></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Middlewares</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nodejs/middlewares/" aria-current="page" title="Middlewares" class="sidebar-link">Middlewares</a></li><li><a href="/nodejs/middlewares/11-error_handling.html" title="Manejo de errores" class="sidebar-link">Manejo de errores</a></li><li><a href="/nodejs/middlewares/12-routes-code.html" title="Códigos de rutas" class="sidebar-link">Códigos de rutas</a></li><li><a href="/nodejs/middlewares/13-body_parser.html" title="Body Parser" class="sidebar-link">Body Parser</a></li><li><a href="/nodejs/middlewares/15-cors.html" aria-current="page" title="CORS" class="active sidebar-link">CORS</a></li></ul></section></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="cors"><a href="#cors" class="header-anchor">#</a> CORS</h1> <p><strong>Intercambio de recursos de origen cruzado (CORS)</strong> es un mecanismo que permite solicitar recursos restringidos en una página web desde <strong>otro dominio</strong> fuera del dominio desde el que se sirvió el primer recurso.</p> <p>Por defecto, este comportamiento no está permitido por razones de seguridad, pero en el caso de RESTful API, la idea es dejar que otros usen el servidor libremente y obtengan los datos proporcionados. Después de agregar CORS a nuestra API, cualquier persona, desde herramientas como Postman y navegadores (páginas web), puede enviarnos una solicitud y obtener la respuesta.</p> <p>Vayamos al archivo app.js y agreguemos el middleware adecuado que manejará esto. Vamos a escribir nuestro propio CORS, pero es posible usar paquetes para lograr el mismo resultado.</p> <p>Lo colocaremos justo después del bodyParser y antes de los controladores de ruta:</p> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token comment">// app.js</span>
<span class="token operator">...</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span>
    <span class="token string">&quot;Access-Control-Allow-Headers&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Origin, X-Requested-With, Content-Type, Accept, Authorization&quot;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">'OPTIONS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Methods'</span><span class="token punctuation">,</span> <span class="token string">'GET, PUT, POST, DELETE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Aquí estamos configurando dos encabezados. Primero, el encabezado &quot;<strong>Access-Control-Allow-Origin</strong>&quot; controla quién puede enviar una solicitud. Al darle el valor <em>, le damos permiso a cualquiera. Para restringir el permiso a un dominio específico, escriba el dominio en lugar del asterisco (</em>).</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Es importante saber que configurar un dominio específico solo lo protegerá de los navegadores. Herramientas como Postman y CURL ignoran esos datos y pueden enviar una solicitud en cualquier condición de CORS.</p></div> <p>El siguiente encabezado es &quot;<strong>Access-Control-Allow-Headers</strong>&quot;, que nos permite configurar diferentes tipos de encabezados con la solicitud. En este caso, &quot;<strong>Origen, X-Solicitado con, Tipo de contenido, Aceptar, Autorización</strong>&quot;.</p> <p>La condición &quot;<strong>req.method === 'OPTIONS'</strong>&quot; se envía de forma predeterminada desde los navegadores justo antes de la solicitud para verificar si tiene permiso para enviar ese tipo de solicitud. En este caso, queremos permitir que el navegador / cliente envíe tipos de solicitudes &quot;GET, PUT, POST, DELETE&quot;.</p> <p>Pero este middleware bloqueará todas las solicitudes entrantes. Necesitamos llamar &quot;return next ()&quot; al final, por lo que después de configurar los encabezados (no enviar una respuesta de método, porque tiene su respuesta / retorno), continuará a nuestros otros middlewares y no se atascará ahí.</p> <div class="custom-block warning"><p class="custom-block-title">IMPORTANTE</p> <p>En el primer caso, no estamos devolviendo una respuesta (solo configurando). Pero en el último caso, donde los navegadores buscan métodos válidos, debemos enviar una respuesta. En este caso, es solo un objeto vacío.</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/nodejs/middlewares/13-body_parser.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        Body Parser
      </a></span> <!----></p></div> </main> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/nodejs/assets/js/app.6530c3e6.js" defer></script><script src="/nodejs/assets/js/2.1eaf5745.js" defer></script><script src="/nodejs/assets/js/43.bf7527f9.js" defer></script>
  </body>
</html>